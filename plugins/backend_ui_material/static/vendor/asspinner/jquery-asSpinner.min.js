/*! jquery asSpinner - v0.2.0 - 2014-09-06
* https://github.com/amazingSurge/jquery-asSpinner
* Copyright (c) 2014 amazingSurge; Licensed GPL */
(function(b){var a=b.asSpinner=function(e,d){this.element=e;this.$element=b(e);this.options=b.extend({},a.defaults,d,this.$element.data());this.namespace=this.options.namespace;if(this.options.rule){var c=this;var f=["min","max","step","precision"];b.each(f,function(g,h){c[h]=a.rules[c.options.rule][h]})}else{this.min=this.options.min;this.max=this.options.max;this.step=this.options.step;this.precision=this.options.precision}this.disabled=this.options.disabled;if(this.$element.prop("disabled")){this.disabled=true}this.value=this.options.parse(this.$element.val());this.mousewheel=this.options.mousewheel;if(this.mousewheel&&!b.event.special.mousewheel){this.mousewheel=false}this.eventBinded=false;this.spinTimeout=null;this.isFocused=false;this.classes={disabled:this.namespace+"_disabled",skin:this.namespace+"_"+this.options.skin,focus:this.namespace+"_focus",control:this.namespace+"-control",down:this.namespace+"-down",up:this.namespace+"-up",wrap:this.namespace};this._trigger("init");this.init()};a.prototype={constructor:a,init:function(){this.$control=b('<div class="'+this.namespace+'-control"><span class="'+this.classes.up+'"></span><span class="'+this.classes.down+'"></span></div>');this.$wrap=this.$element.wrap('<div tabindex="0" class="'+this.classes.wrap+'"></div>').parent();this.$down=this.$control.find("."+this.classes.down);this.$up=this.$control.find("."+this.classes.up);if(this.options.skin){this.$wrap.addClass(this.classes.skin)}this.$control.appendTo(this.$wrap);if(this.disabled===false){this.bindEvent()}else{this.disable()}this._trigger("ready")},_trigger:function(d){var c=Array.prototype.slice.call(arguments,1),f=[this].concat(c.concat);this.$element.trigger("asSpinner::"+d,f);d=d.replace(/\b\w+\b/g,function(g){return g.substring(0,1).toUpperCase()+g.substring(1)});var e="on"+d;if(typeof this.options[e]==="function"){this.options[e].apply(this,c)}},spin:function(d,e){var c=this;var f=function(g){clearTimeout(c.spinTimeout);c.spinTimeout=setTimeout(function(){d.call(c);f(60)},g)};f(e||500)},bindEvent:function(){var c=this;this.eventBinded=true;this.$wrap.on("focus.asSpinner",function(){c.$wrap.addClass(c.classes.focus)}).on("blur.asSpinner",function(){if(!c.isFocused){c.$wrap.removeClass(c.classes.focus)}});this.$down.on("mousedown.asSpinner",function(){b(document).one("mouseup.asSpinner",function(){clearTimeout(c.spinTimeout)});c.spin(c.spinDown)}).on("mouseup.asSpinner",function(){clearTimeout(c.spinTimeout);b(document).off("mouseup.asSpinner")}).on("click.asSpinner",function(){c.spinDown.call(c)});this.$up.on("mousedown.asSpinner",function(){b(document).one("mouseup.asSpinner",function(){clearTimeout(c.spinTimeout)});c.spin(c.spinUp)}).on("mouseup.asSpinner",function(){clearTimeout(c.spinTimeout);b(document).off("mouseup.asSpinner")}).on("click.asSpinner",function(){c.spinUp.call(c)});this.$element.on("focus.asSpinner",function(){c.isFocused=true;c.$wrap.addClass(c.classes.focus);b(this).on("keydown.asSpinner",function(f){var d=f.keyCode||f.which;if(d===38){c.applyValue();c.spinUp();return false}if(d===40){c.applyValue();c.spinDown();return false}if(d<=57&&d>=48){setTimeout(function(){},0)}});if(c.mousewheel===true){b(this).mousewheel(function(d,e){if(e>0){c.spinUp()}else{c.spinDown()}return false})}}).on("blur.asSpinner",function(){c.isFocused=false;c.$wrap.removeClass(c.classes.focus);b(this).off("keydown.asSpinner");if(c.mousewheel===true){b(this).unmousewheel()}c.applyValue()})},unbindEvent:function(){this.eventBinded=false;this.$element.off(".asSpinner");this.$down.off(".asSpinner");this.$up.off(".asSpinner");this.$wrap.off(".asSpinner")},isNumber:function(c){if(typeof c==="number"&&b.isNumeric(c)){return true}else{return false}},isOutOfBounds:function(c){if(c<this.min){return -1}if(c>this.max){return 1}return 0},applyValue:function(){if(this.options.format(this.value)!==this.$element.val()){this.set(this.options.parse(this.$element.val()))}},_set:function(d){if(isNaN(d)){d=this.min}var c=this.isOutOfBounds(d);if(c!==0){if(this.options.looping===true){d=(c===1)?this.min:this.max}else{d=(c===-1)?this.min:this.max}}this.value=d=Number(d).toFixed(this.precision);this.$element.val(this.options.format(this.value))},set:function(c){this._set(c);this._trigger("change",this.value,this.options.name,"asSpinner")},get:function(){return this.value},update:function(d){var c=this;["min","max","precision","step"].map(function(e){if(d[e]){c[e]=d[e]}});if(d.value){this.set(d.value)}return this},val:function(c){if(c){this.set(this.options.parse(c))}else{return this.get()}},spinDown:function(){if(!b.isNumeric(this.value)){this.value=0}this.value=parseFloat(this.value)-parseFloat(this.step);this.set(this.value);return this},spinUp:function(){if(!b.isNumeric(this.value)){this.value=0}this.value=parseFloat(this.value)+parseFloat(this.step);this.set(this.value);return this},enable:function(){this.disabled=false;this.$wrap.removeClass(this.classes.disabled);this.$element.prop("disabled",false);if(this.eventBinded===false){this.bindEvent()}return this},disable:function(){this.disabled=true;this.$element.prop("disabled",true);this.$wrap.addClass(this.classes.disabled);this.unbindEvent();return this},destroy:function(){this.unbindEvent();this.$control.remove();this.$element.unwrap();return this}};a.rules={defaults:{min:null,max:null,step:1,precision:0},currency:{min:0,max:99999,step:0.01,precision:2},quantity:{min:1,max:999,step:1,precision:0},percent:{min:1,max:100,step:1,precision:0},month:{min:1,max:12,step:1,precision:0},day:{min:1,max:31,step:1,precision:0},hour:{min:0,max:23,step:1,precision:0},minute:{min:1,max:59,step:1,precision:0},second:{min:1,max:59,step:1,precision:0}};a.defaults={namespace:"asSpinner",skin:null,disabled:false,min:-10,max:10,step:1,name:null,precision:0,rule:null,looping:true,mousewheel:false,format:function(c){return c},parse:function(c){return parseFloat(c)}};b.fn.asSpinner=function(c){if(typeof c==="string"){var f=c;var d=Array.prototype.slice.call(arguments,1);if(/^\_/.test(f)){return false}else{if((/^(get)$/.test(f))||(f==="val"&&d.length===0)){var e=this.first().data("asSpinner");if(e&&typeof e[f]==="function"){return e[f].apply(e,d)}}else{return this.each(function(){var g=b.data(this,"asSpinner");if(g&&typeof g[f]==="function"){g[f].apply(g,d)}})}}}else{return this.each(function(){if(!b.data(this,"asSpinner")){b.data(this,"asSpinner",new a(this,c))}})}}}(window.jQuery));