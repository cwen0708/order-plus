var page=require("webpage").create();page.open("http://localhost:3000/test/index.html",function(a){if(a!="success"){console.log("page couldn't be loaded successfully");phantom.exit(1)}waitFor(function(){return page.evaluate(function(){var b=document.getElementById("status");if(!b){return false}return(/^(\d+ failures?|all passed)/i).test(b.innerText)})},function(){var b=page.evaluate(function(){return window.failed});var c=page.evaluate(function(){return document.getElementById("output").innerText+"\n"+document.getElementById("status").innerText});console.log(c);phantom.exit(b>0?1:0)})});function waitFor(b,a){if(b()){a()}else{setTimeout(function(){waitFor(b,a)},250)}};